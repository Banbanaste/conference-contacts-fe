import React, { useState } from 'react';
import QrReader from 'react-qr-reader';
import Popup from "reactjs-popup";
import { navigate } from '@reach/router';

const contentStyle = {
    width: '90%',
    height: '80%',
    borderRadius: '0.9rem',
}

const QrCodeReader = () => {
    const [result, setResult] = useState('')

    const handleScan = data => {
        if(data){
            setResult(data)
            return navigate('profile')
        }
    }

    const handleError = err => {
        console.log(err)
    }

    return (
        <Popup 
            trigger={
                <button className="focus:outline-none">
                    <svg width="54" height="46" viewBox="0 0 54 46" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M49 7.5H40.5L38.475 1.825C38.3351 1.43668 38.0787 1.10101 37.7409 0.86386C37.4031 0.626709 37.0003 0.499636 36.5875 0.500001H17.4125C16.5687 0.500001 15.8125 1.03125 15.5312 1.825L13.5 7.5H5C2.2375 7.5 0 9.7375 0 12.5V41C0 43.7625 2.2375 46 5 46H49C51.7625 46 54 43.7625 54 41V12.5C54 9.7375 51.7625 7.5 49 7.5ZM49.5 41C49.5 41.275 49.275 41.5 49 41.5H5C4.725 41.5 4.5 41.275 4.5 41V12.5C4.5 12.225 4.725 12 5 12H16.6687L17.7375 9.0125L19.1687 5H34.825L36.2562 9.0125L37.325 12H49C49.275 12 49.5 12.225 49.5 12.5V41ZM27 16C21.475 16 17 20.475 17 26C17 31.525 21.475 36 27 36C32.525 36 37 31.525 37 26C37 20.475 32.525 16 27 16ZM27 32C23.6875 32 21 29.3125 21 26C21 22.6875 23.6875 20 27 20C30.3125 20 33 22.6875 33 26C33 29.3125 30.3125 32 27 32Z" fill="black"/>
                    </svg>
                </button>
            } 
            modal
            contentStyle={contentStyle}
            >
            {close => (
                <div>
                    <div className='flex justify-end items-center mr-2 mt-2'>
                        <button className="focus:outline-none p-2 bg-gray-300 rounded-full" onClick={close}>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fillRule="evenodd" clipRule="evenodd" d="M17.9117 18.674C18.3022 19.0646 18.9354 19.0646 19.3259 18.674C19.7164 18.2835 19.7164 17.6503 19.3259 17.2598L13.6798 11.6138L19.6304 5.66316C20.021 5.27264 20.021 4.63947 19.6304 4.24895C19.2399 3.85842 18.6068 3.85842 18.2162 4.24895L12.2656 10.1996L6.31502 4.24895C5.92449 3.85842 5.29133 3.85842 4.9008 4.24895C4.51028 4.63947 4.51028 5.27264 4.9008 5.66316L10.8514 11.6138L5.20537 17.2598C4.81484 17.6503 4.81484 18.2835 5.20537 18.674C5.59589 19.0646 6.22906 19.0646 6.61958 18.674L12.2656 13.028L17.9117 18.674Z" fill="black"/>
                            </svg>
                        </button>
                    </div>
                    <div className="flex flex-col justify-center my-6 mx-4">
                        <QrReader
                            // delay={100}
                            onError={handleError}
                            onScan={handleScan}
                            style={{ width: '100%' }}
                            className='my-6'
                            showViewFinder={true}
                        /> 
                        <p className='text-3xl text-center border-t-4 mt-6 pt-10 mx-2'>Align QR code to swaap information</p> 
                        {/* <p className='text-center text-2xl mb-2'>OR</p>
                        <div className=' flex justify-center items-center my-2'>
                            <svg className='qr-icon-blue rounded-full w-1/3 py-4 px-2 w-24 h-20' width='50' height='50' viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13.3672 0.75H1.9375C1.28066 0.75 0.75 1.28066 0.75 1.9375V13.3672C0.75 13.5305 0.883594 13.6641 1.04687 13.6641H13.3672C13.5305 13.6641 13.6641 13.5305 13.6641 13.3672V1.04688C13.6641 0.883594 13.5305 0.75 13.3672 0.75ZM11.2891 11.2891H3.125V3.125H11.2891V11.2891ZM6.16797 8.54297H8.24609C8.40937 8.54297 8.54297 8.40938 8.54297 8.24609V6.16797C8.54297 6.00469 8.40937 5.87109 8.24609 5.87109H6.16797C6.00469 5.87109 5.87109 6.00469 5.87109 6.16797V8.24609C5.87109 8.40938 6.00469 8.54297 6.16797 8.54297ZM13.3672 16.3359H1.04687C0.883594 16.3359 0.75 16.4695 0.75 16.6328V28.0625C0.75 28.7193 1.28066 29.25 1.9375 29.25H13.3672C13.5305 29.25 13.6641 29.1164 13.6641 28.9531V16.6328C13.6641 16.4695 13.5305 16.3359 13.3672 16.3359ZM11.2891 26.875H3.125V18.7109H11.2891V26.875ZM6.16797 24.1289H8.24609C8.40937 24.1289 8.54297 23.9953 8.54297 23.832V21.7539C8.54297 21.5906 8.40937 21.457 8.24609 21.457H6.16797C6.00469 21.457 5.87109 21.5906 5.87109 21.7539V23.832C5.87109 23.9953 6.00469 24.1289 6.16797 24.1289ZM28.0625 0.75H16.6328C16.4695 0.75 16.3359 0.883594 16.3359 1.04688V13.3672C16.3359 13.5305 16.4695 13.6641 16.6328 13.6641H28.9531C29.1164 13.6641 29.25 13.5305 29.25 13.3672V1.9375C29.25 1.28066 28.7193 0.75 28.0625 0.75ZM26.875 11.2891H18.7109V3.125H26.875V11.2891ZM21.7539 8.54297H23.832C23.9953 8.54297 24.1289 8.40938 24.1289 8.24609V6.16797C24.1289 6.00469 23.9953 5.87109 23.832 5.87109H21.7539C21.5906 5.87109 21.457 6.00469 21.457 6.16797V8.24609C21.457 8.40938 21.5906 8.54297 21.7539 8.54297ZM28.9531 16.3359H27.1719C27.0086 16.3359 26.875 16.4695 26.875 16.6328V21.6055H23.9805V16.6328C23.9805 16.4695 23.8469 16.3359 23.6836 16.3359H16.6328C16.4695 16.3359 16.3359 16.4695 16.3359 16.6328V28.9531C16.3359 29.1164 16.4695 29.25 16.6328 29.25H18.4141C18.5773 29.25 18.7109 29.1164 18.7109 28.9531V19.8984H21.6055V23.6836C21.6055 23.8469 21.7391 23.9805 21.9023 23.9805H28.9531C29.1164 23.9805 29.25 23.8469 29.25 23.6836V16.6328C29.25 16.4695 29.1164 16.3359 28.9531 16.3359ZM23.6836 26.875H21.9023C21.7391 26.875 21.6055 27.0086 21.6055 27.1719V28.9531C21.6055 29.1164 21.7391 29.25 21.9023 29.25H23.6836C23.8469 29.25 23.9805 29.1164 23.9805 28.9531V27.1719C23.9805 27.0086 23.8469 26.875 23.6836 26.875ZM28.9531 26.875H27.1719C27.0086 26.875 26.875 27.0086 26.875 27.1719V28.9531C26.875 29.1164 27.0086 29.25 27.1719 29.25H28.9531C29.1164 29.25 29.25 29.1164 29.25 28.9531V27.1719C29.25 27.0086 29.1164 26.875 28.9531 26.875Z" fill="#F6F7FB"/>
                            </svg>
                        </div>         */}
                    </div>
                </div>
            )}
      </Popup>
    )

}

export default QrCodeReader;